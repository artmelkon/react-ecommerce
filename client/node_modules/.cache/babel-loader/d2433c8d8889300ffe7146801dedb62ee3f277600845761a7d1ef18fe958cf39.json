{"ast":null,"code":"var _jsxFileName = \"/Users/arthurmelkonyan/webdev/react-ecommerce/client/src/components/checkout/custom-checkout/index.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { withRouter } from 'react-router-dom';\nimport { CardNumberElement, CardExpiryElement, CardCvcElement, useStripe, useElements } from '@stripe/react-stripe-js';\nimport { fetchFormAPI } from '../../../lib/helper';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CustomCheckout = ({\n  shipping,\n  cartItems,\n  history: {\n    push\n  }\n}) => {\n  _s();\n  const [processing, setProcessing] = useState(false);\n  const [error, setError] = useState(null);\n  const [clientSecret, setClientSecret] = useState(null);\n  const elements = useElements();\n  const stripe = useStripe();\n  useEffect(() => {\n    const items = cartItems.map(item => ({\n      price: item.price,\n      quantity: item.quantity\n    }));\n    if (shipping) {\n      const body = {\n        cartItems: items,\n        shipping: {\n          name: shipping.name,\n          address: {\n            line1: shipping.address\n          }\n        },\n        description: 'payment intent for nomad shop',\n        receipt_email: shipping.email\n      };\n      async function CustomCheckout() {\n        const {\n          clientSecret\n        } = await fetchFormAPI('create-payment-intent', {\n          body\n        });\n        setClientSecret(clientSecret);\n      }\n      CustomCheckout();\n    }\n  }, [shipping, cartItems]);\n  async function handleCheckout() {\n    setProcessing(true);\n    const payload = await stripe.confirmCardPayment(clientSecret, {\n      payment_method: {\n        card: elements.getElement(CardNumberElement)\n      }\n    });\n    if (payload.error) setError(`Payment failed: ${payload.error.message}`);else push('/success');\n  }\n  function cardHandleChange(e) {\n    const {\n      error\n    } = e;\n    setError(error ? error.message : '');\n  }\n  const cardStyle = {\n    style: {\n      base: {\n        color: '#000',\n        fontFamily: 'Robot, sans-serif',\n        fontSmoothing: 'antialiased',\n        fontSize: '16px',\n        \"::placeholder\": {\n          color: '#606060'\n        }\n      },\n      invalid: {\n        color: '#fa755a',\n        iconColor: '#fa755a'\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n      children: \"Enter Payment Ditales\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"stripe-card\",\n      children: /*#__PURE__*/_jsxDEV(CardNumberElement, {\n        className: \"card-element\",\n        options: cardStyle,\n        onChange: cardHandleChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"stripe-card\",\n      children: /*#__PURE__*/_jsxDEV(CardExpiryElement, {\n        className: \"card-element\",\n        options: cardStyle,\n        onChange: cardHandleChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"stripe-card\",\n      children: /*#__PURE__*/_jsxDEV(CardCvcElement, {\n        className: \"card-element\",\n        options: cardStyle,\n        onChange: cardHandleChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"submit-btn\",\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        disabled: processing,\n        className: \"button is-black nomad-btn submit\",\n        onClick: handleCheckout,\n        children: processing ? 'PROCESSING' : 'PAY'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 5\n    }, this), error && /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"error-message\",\n      children: error.message\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 76,\n    columnNumber: 10\n  }, this);\n};\n_s(CustomCheckout, \"nkDG/ibxgfwl8yrrnif+AGsZHeA=\", false, function () {\n  return [useElements, useStripe];\n});\n_c = CustomCheckout;\nexport default _c2 = withRouter(CustomCheckout);\nvar _c, _c2;\n$RefreshReg$(_c, \"CustomCheckout\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"names":["React","useState","useEffect","withRouter","CardNumberElement","CardExpiryElement","CardCvcElement","useStripe","useElements","fetchFormAPI","jsxDEV","_jsxDEV","CustomCheckout","shipping","cartItems","history","push","_s","processing","setProcessing","error","setError","clientSecret","setClientSecret","elements","stripe","items","map","item","price","quantity","body","name","address","line1","description","receipt_email","email","handleCheckout","payload","confirmCardPayment","payment_method","card","getElement","message","cardHandleChange","e","cardStyle","style","base","color","fontFamily","fontSmoothing","fontSize","invalid","iconColor","children","fileName","_jsxFileName","lineNumber","columnNumber","className","options","onChange","disabled","onClick","_c","_c2","$RefreshReg$"],"sources":["/Users/arthurmelkonyan/webdev/react-ecommerce/client/src/components/checkout/custom-checkout/index.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { withRouter } from 'react-router-dom'\nimport { CardNumberElement, CardExpiryElement, CardCvcElement, useStripe, useElements } from '@stripe/react-stripe-js';\n\nimport { fetchFormAPI } from '../../../lib/helper'\n\nconst CustomCheckout = ({ shipping, cartItems, history: { push } }) => {\n  const [processing, setProcessing] = useState(false);\n  const [error, setError] = useState(null);\n  const [clientSecret, setClientSecret] = useState(null);\n  const elements = useElements();\n  const stripe = useStripe();\n\n  useEffect(() => {\n    const items = cartItems.map(item => ({ price: item.price, quantity: item.quantity }))\n    if (shipping) {\n      const body = {\n        cartItems: items,\n        shipping: {\n          name: shipping.name,\n          address: {\n            line1: shipping.address\n          }\n        },\n        description: 'payment intent for nomad shop',\n        receipt_email: shipping.email\n      }\n\n      async function CustomCheckout() {\n        const { clientSecret } = await fetchFormAPI('create-payment-intent', {\n          body\n        });\n        setClientSecret(clientSecret)\n      }\n      CustomCheckout()\n    }\n  }, [shipping, cartItems]);\n\n\n  async function handleCheckout() {\n    setProcessing(true);\n    const payload = await stripe.confirmCardPayment(clientSecret, {\n      payment_method: {\n        card: elements.getElement(CardNumberElement)\n      }\n    });\n\n    if (payload.error) setError(`Payment failed: ${payload.error.message}`)\n    else push('/success')\n  }\n\n  function cardHandleChange(e) {\n    const { error } = e;\n    setError(error ? error.message : '');\n  }\n\n  const cardStyle = {\n    style: {\n      base: {\n        color: '#000',\n        fontFamily: 'Robot, sans-serif',\n        fontSmoothing: 'antialiased',\n        fontSize: '16px',\n        \"::placeholder\": {\n          color: '#606060'\n        }\n      },\n      invalid: {\n        color: '#fa755a',\n        iconColor: '#fa755a'\n      }\n    }\n  }\n\n\n  return <div>\n    <h4>Enter Payment Ditales</h4>\n    <div className='stripe-card'>\n      <CardNumberElement\n        className='card-element'\n        options={cardStyle}\n        onChange={cardHandleChange}\n      />\n    </div>\n    <div className='stripe-card'>\n      <CardExpiryElement\n        className='card-element'\n        options={cardStyle}\n        onChange={cardHandleChange}\n      />\n    </div>\n    <div className='stripe-card'>\n      <CardCvcElement\n        className='card-element'\n        options={cardStyle}\n        onChange={cardHandleChange}\n      />\n    </div>\n    <div className='submit-btn'>\n      <button disabled={processing} className='button is-black nomad-btn submit' onClick={handleCheckout}>\n        {\n          processing ? 'PROCESSING' : 'PAY'\n        }\n      </button>\n    </div>\n    {\n      error && (<p className='error-message'>{error.message}</p>)\n    }\n  </div>;\n}\n\nexport default withRouter(CustomCheckout);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}